<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8"/>
    <meta http-equiv="X-UA-Compatible" content="IE=edge"/>
    <meta name="viewport" content="width=device-width, initial-scale=1"/>
    <meta name="description" content="卡方检验 - zzj666's Little Site - 作者:zzj666"/> 
	
    <title>卡方检验 - zzj666's Little Site</title>
    <!-- Bootstrap Core CSS -->
    <link href="/css/bootstrap.min.css" rel="stylesheet"/>
    <!-- Custom CSS -->
    <link href="/css/blog.css" rel="stylesheet"/>

    <script src="/js/jquery-1.11.0.js"> </script>
    <!-- Bootstrap Core JavaScript -->
    <script src="/js/bootstrap.min.js"></script>
    <script src="/js/tongji.js"></script>

	<script type="text/x-mathjax-config">
		MathJax.Hub.Config({tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']]}});
	</script>
	<script type="text/javascript" async src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_CHTML">
	</script>

  
  <body>
    <!-- Navigation -->
    <nav class="navbar navbar-inverse navbar-fixed-top" role="navigation">
      <div class="container">
        <!-- Brand and toggle get grouped for better mobile display -->
        <div class="navbar-header">
          <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
            <span class="sr-only">
              Toggle navigation
            </span>
            <span class="icon-bar">
            </span>
            <span class="icon-bar">
            </span>
            <span class="icon-bar">
            </span>
          </button>
          <a class="navbar-brand" href="/">
            首页
          </a>
        </div>
        <!-- Collect the nav links, forms, and other content for toggling -->
        <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
          		<ul class="nav navbar-nav">
			
				<li>
				  <a href="/math/index.html">
					数学
				  </a>
				</li>
			
				<li>
				  <a href="/termux/index.html">
					Termux
				  </a>
				</li>
			
				<li>
				  <a href="/linux/index.html">
					Linux
				  </a>
				</li>
			
				<li>
				  <a href="/git/index.html">
					git
				  </a>
				</li>
			
				<li>
				  <a href="/develop/index.html">
					开发
				  </a>
				</li>
			
				<li>
				  <a href="/other/index.html">
					杂记
				  </a>
				</li>
			
				<li>
				  <a href="/read/index.html">
					书摘
				  </a>
				</li>
			
				<li>
				  <a href="/about.html">
					关于
				  </a>
				</li>
			
		</ul>  
        </div>
        <!-- /.navbar-collapse -->
      </div>
      <!-- /.container -->
    </nav>
    <!-- Page Content -->
    <div class="container">
      <div class="row">
        <!-- Blog Entries Column -->
        <div class="col-md-8">
          



<div  class="post_frame">
<!-- Navi -->
<div class="post_navi">
	<a href="/">首页</a>&nbsp;>&nbsp;
	<a href=""></a>&nbsp;>&nbsp;
	<span class="post_navi_span">正文</span>
</div>

<!-- Title -->
<div class="post_titlearea">
	<h1>卡方检验</h1>
	<hr class="hrline"/>
	<div class="post_titledate"/>
		&nbsp;&nbsp;&nbsp;
		栏目：<a href=""></a>&nbsp;&nbsp;&nbsp;
		&nbsp;&nbsp;&nbsp;
		日期：2019-11-04&nbsp;&nbsp;&nbsp;		
	</div>
</div>

<div style="text-indent:2em;padding:10px">
<h1 id="卡方检验转">卡方检验[转]</h1>
<p><strong>卡方检验(Chi-square test/Chi-Square Goodness-of-Fit Test)</strong></p>
<h2 id="什么是卡方检验">什么是卡方检验</h2>
<p>卡方检验是一种用途很广的计数资料的假设检验方法。它属于非参数检验的范畴，主要是比较两个及两个以上样本率( 构成比）以及两个分类变量的关联性分析。其根本思想就是在于比较理论频数和实际频数的吻合程度或拟合优度问题。
<!-- more -->
它在分类资料统计推断中的应用，包括：两个率或两个构成比比较的卡方检验；多个率或多个构成比比较的卡方检验以及分类资料的相关分析等。</p>

<h2 id="卡方检验的基本原理">卡方检验的基本原理</h2>
<h3 id="卡方检验的基本思想">卡方检验的基本思想</h3>
<p>卡方检验是以$χ^2$分布为基础的一种常用假设检验方法，它的无效假设$H_0$是：观察频数与期望频数没有差别。</p>

<p>该检验的基本思想是：首先假设$H_0$成立，基于此前提计算出$χ^2$值，它表示观察值与理论值之间的偏离程度。根据$χ^2$分布及自由度可以确定在$H_0$假设成立的情况下获得当前统计量及更极端情况的概率P。如果P值很小，说明观察值与理论值偏离程度太大，应当拒绝无效假设，表示比较资料之间有显著差异；否则就不能拒绝无效假设，尚不能认为样本所代表的实际情况和理论假设有差别。</p>

<h2 id="卡方值的计算与意义">卡方值的计算与意义</h2>
<p>$χ^2$值表示观察值与理论值之问的偏离程度。计算这种偏离程度的基本思路如下。</p>

<p>(1)设A代表某个类别的观察频数，E代表基于$H_0$计算出的期望频数，A与E之差称为残差。</p>

<p>(2)显然，残差可以表示某一个类别观察值和理论值的偏离程度，但如果将残差简单相加以表示各类别观察频数与期望频数的差别，则有一定的不足之处。因为残差有正有负，相加后会彼此抵消，总和仍然为0，为此可以将残差平方后求和。</p>

<p>(3)另一方面，残差大小是一个相对的概念，相对于期望频数为10时，期望频数为20的残差非常大，但相对于期望频数为1 000时20的残差就很小了。考虑到这一点，人们又将残差平方除以期望频数再求和，以估计观察频数与期望频数的差别。</p>

<p>进行上述操作之后，就得到了常用的$χ^2$统计量，由于它最初是由英国统计学家Karl Pearson在1900年首次提出的，因此也称之为Pearson $χ^2$，其计算公式为</p>

<script type="math/tex; mode=display">x^2=\sum \frac{(A-E)^2}E=\sum_{n-1}^k\frac{(A_i-E_i)^2}{E_i}=\sum_{i=1}^k\frac{(A_i-np_i)^2}{np_i},(i=1,2,3,\ldots,k)</script>

<p>其中，$A_i$为i水平的观察频数，$E_i$为i水平的期望频数，n为总频数，$p_i$为i水平的期望频率。i水平的期望频数$E_i$等于总频数n×i水平的期望概率$p_i$，k为单元格数。当n比较大时，$χ_2$统计量近似服从k-1(计算$E_i$时用到的参数个数)个自由度的卡方分布。</p>

<p>作为学术界的领袖，Pearson先生当初发表在《哲学杂志》上的$χ^2$论文题目为：On the criterion that a given system of deviations from the probable in the case of a correlated system of variables is such that it can be reasonably supposed to have arisen from random sampling.</p>

<p>由卡方的计算公式可知，当观察频数与期望频数完全一致时，$χ^2$值为0；观察频数与期望频数越接近，两者之间的差异越小，$χ^2$值越小；反之，观察频数与期望频数差别越大，两者之间的差异越大，$χ^2$值越大。换言之，大的$χ^2$值表明观察频数远离期望频数，即表明远离假设。小的χ2值表明观察频数接近期望频数，接近假设。因此，$χ^2$是观察频数与期望频数之间距离的一种度量指标，也是假设成立与否的度量指标。如果$χ^2$值“小”，研究者就倾向于不拒绝$H_0$；如果$χ^2$值大，就倾向于拒绝$H_0$。至于$χ^2$在每个具体研究中究竟要大到什么程度才能拒绝H0，则要借助于卡方分布求出所对应的P值来确定。</p>

<h2 id="卡方检验的样本量要求">卡方检验的样本量要求</h2>
<p>卡方分布本身是连续型分布，但是在分类资料的统计分析中，显然频数只能以整数形式出现，因此计算出的统计量是非连续的。只有当样本量比较充足时，才可以忽略两者间的差异，否则将可能导致较大的偏差具体而言，一般认为对于卡方检验中的每一个单元格，要求其最小期望频数均大于1，且至少有4／5的单元格期望频数大于5，此时使用卡方分布计算出的概率值才是准确的。如果数据不符合要求，可以采用确切概率法进行概率的计算。</p>

<h3 id="卡方检验的类型">卡方检验的类型</h3>
<h4 id="1四格表资料的卡方检验">1、四格表资料的卡方检验</h4>
<p>四格表资料的卡方检验用于进行两个率或两个构成比的比较。</p>

<p>1）专用公式：</p>

<p>若四格表资料四个格子的频数分别为a，b，c，d，则四格表资料卡方检验的</p>

<script type="math/tex; mode=display">卡方值=(ad-bc)^2\frac n{(a+b)(c+d)(a+c)(b+d)}</script>

<p>,</p>

<script type="math/tex; mode=display">自由度v=(行数-1)(列数-1)</script>

<p>2、行×列表资料的卡方检验</p>

<p>行×列表资料的卡方检验用于多个率或多个构成比的比较。</p>

<p>1）专用公式：</p>

<p>r行c列表资料卡方检验的</p>

<script type="math/tex; mode=display">卡方值=n[(\frac {A_{11}}{n_1n_1}+\frac {A_{12}}{n_1n_2}+\ldots+\frac {A_{rc}}{n_rn_c})]-1</script>

<p>2)应用条件：</p>

<p>要求每个格子中的理论频数T均大于5或1&lt;T&lt;5的格子数不超过总格子数的1/5。当有T&lt;1或1&lt;T&lt;5的格子较多时，可采用并行并列、删行删列、增大样本含量的办法使其符合行×列表资料卡方检验的应用条件。而多个率的两两比较可采用行×列表分割的办法。</p>

<p>3、列联表资料的卡方检验</p>

<p>同一组对象，观察每一个个体对两种分类方法的表现，结果构成双向交叉排列的统计表就是列联表。</p>

<p>1）R×C 列联表的卡方检验：</p>

<p>R×C 列联表的卡方检验用于R×C列联表的相关分析，卡方值的计算和检验过程与行×列表资料的卡方检验相同。</p>

<p>2）2×2列联表的卡方检验：</p>

<p>2×2列联表的卡方检验又称配对记数资料或配对四格表资料的卡方检验，根据卡方值计算公式的不同，可以达到不同的目的。当用一般四格表的卡方检验计算时，</p>

<p>$卡方值=(ad-bc)^2\frac n{(a+b)(c+d)(a+c)(b+d)}$</p>

<table>
  <tbody>
    <tr>
      <td>，此时用于进行配对四格表的相关分析，如考察两种检验方法的结果有无关系；当$卡方值=\frac {(</td>
      <td>b-c</td>
      <td>-1)^2}{b+c}$时，此时卡方检验用来进行四格表的差异检验，如考察两种检验方法的检出率有无差别。</td>
    </tr>
  </tbody>
</table>

<p>列联表卡方检验应用中的注意事项同R×C表的卡方检验相同。</p>

<h2 id="卡方检验的用途">卡方检验的用途</h2>
<p>卡方检验最常见的用途就是考察某无序分类变量各水平在两组或多组间的分布是否一致实际上，除了这个用途之外．卡方检验还有更广泛的应用。具体而言，其用途主要包括以下几个方面：</p>

<p>(1)检验某个连续变量的分布是否与某种理论分布相一致。如是否符合正态分布、是否服从均匀分布、是否服从Poisson分布等。</p>

<p>(2)检验某个分类变量各类的出现概率是否等于指定概率。如在36选7的彩票抽奖中，每个数字出现的概率是否各为$\frac 1{36}$；掷硬币时，正反两面出现的概率是否均为0.5。</p>

<p>(3)检验某两个分类变量是否相互独立。如吸烟(二分类变量：是、否)是否与呼吸道疾病(二分类变量：是、否)有关；产品原料种类(多分类变量)是否与产品合格(二分类变量)有关。</p>

<p>(4)检验控制某种或某几种分类因素的作用以后，另两个分类变量是否相互独立。如在上例中，控制性别、年龄因素影响以后，吸烟是否和呼吸道疾病有关；控制产品加工工艺的影响后，产品原料类别是否与产品合格有关。</p>

<p>(5)检验某两种方法的结果是否一致。如采用两种诊断方法对同一批人进行诊断，其诊断结果是否一致；采用两种方法对客户进行价值类别预测，预测结果是否一致</p>

<h2 id="卡方检验的应用条件">卡方检验的应用条件</h2>
<p>适用于四格表应用条件：</p>

<p>1)随机样本数据。两个独立样本比较可以分以下3种情况：</p>

<p>(1)所有的理论数T≥5并且总样本量n≥40，用Pearson卡方进行检验。</p>

<p>(2)如果理论数T＜5但T≥1，并且n≥40，用连续性校正的卡方进行检验。</p>

<p>(3)如果有理论数T＜1或n＜40，则用Fisher’s检验。</p>

<p>2)卡方检验的理论频数不能太小。</p>

<p>R×C表卡方检验应用条件：</p>

<p>(1)R×C表中理论数小于5的格子不能超过1／5；</p>

<p>(2)不能有小于1的理论数。如果实验中有不符合R×C表的卡方检验，可以通过增加样本数、列合并来实现。</p>

<h2 id="卡方检验应用实例">卡方检验应用实例</h2>
<h3 id="1应用实例适合度检验">1.应用实例——适合度检验</h3>

<p>实际执行多项式试验而得到的观察次数，与虚无假设的期望次数相比较，称为卡方适度检验，即在于检验二者接近的程度，利用样本数据以检验总体分布是否为某一特定分布的统计方法。这里以掷骰子为例介绍适度检验的方法。</p>

<p>【例1】</p>

<p>(1)假设掷一骰子120次，各点数共出现次数为a，b为各点数出现的期望值$120×\frac16=20$，建立工作表文件，如图1所示。</p>

<p>(2)设置零假设$H_0$：观察分布等于期望分布。</p>

<p>(3)计算卡方检验统计量，如图2所示。</p>

<p>D2=(B2-C2)^2/C2</p>

<p>D8=SUM(D2:D7)</p>

<p><a href="https://imgchr.com/i/Kxene0"><img src="https://s2.ax1x.com/2019/11/04/Kxene0.md.jpg" alt="Kxene0.md.jpg" /></a></p>

<p>(4)确定自由度，(6-1)×(2-1)=5；选择显著水平α=0.05。</p>

<p>(5)利用Excel提供的CHIINV函数求临界值，在D9单元格中键入“=CHIINV(0.05，5)”按回车键，得临界值11.07。</p>

<p>(6)比较临界值和统计量，11.07&gt;2.3，即临界值大于统计量，故差异不显著，接受H0。</p>

<h4 id="2应用实例2独立性检验">2.应用实例2——独立性检验</h4>

<p>卡方独立性检验是用来检验两个属性间是否独立。一个变量作为行，另一个变量作为列。下面一例便是介绍卡方独立性检验的方法。</p>

<p>【例2】某机构欲了解现在性别与收入是否有关，他们随机抽样500人，询问对此的看法，结果分为“有关、无关、不好说，，三种答案，图3中县调查得到的数据。</p>

<p><img src="https://s2.ax1x.com/2019/11/04/KxeAzj.png" alt="KxeAzj.png" /></p>

<p>下面是利用Excel解决此问题的步骤。</p>

<p>(1)零假设$H_0$：性别与收入无关。</p>

<p>(2)确定自由度为(3-1)×(2-1)=2，选择显著水平α=0.05。</p>

<p>(3)求解男女对收入与性别相关不同看法的期望次数，这里采用所在行列的合计值的乘机除以总计值来计算每一个期望值，如图4所示，在单元格B9中键入“=B5*E3/E5”，同理(第一个等于号理解为在单元格中键入)：</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>B10=“=B5*E4/E5，
C9=“=C5*E3/E5”，
C10=“=C5*E4/E5”，
D9=“=D5*E3/E5”，
D10=“=D5*E4/E5” 。
</code></pre></div></div>

<p><img src="https://s2.ax1x.com/2019/11/04/KxeVQs.png" alt="KxeVQs.png" /></p>

<p>(4)利用卡方统计量计算公式计算统计量，在单元格B15中键入“=(B3-B9)^2/B9”，其余单元格依次类推，结果如图5所示。</p>

<p><img src="https://s2.ax1x.com/2019/11/04/KxeZyn.png" alt="KxeZyn.png" /></p>

<script type="math/tex; mode=display">X^2=\sum\frac{(f_0-f_e)^2}{f_e}=14.32483</script>

<p>(5)利用Excel提供的CHIINV函数计算显著水平为0.05，自由度为2卡方分布的临界值，在Excel单元格中键入“=CHIINV(0.05,2)”按回车键，得临界值为5.9915。</p>

<p>(6)比较统计量度和临界值，统计量14.32483大于临界值5.9915，故拒绝零假设。</p>

<h4 id="3应用实例3统一性检验">3．应用实例3——统一性检验</h4>

<p>检验两个或两个以上总体的某一特性分布，也就是各“类别”的比例是否统一或相近，一般称为卡方统一性检验或者卡方同质性检验。下面一例便是利用卡方统一性检验的例子。</p>

<p>【倒3】某咨询公司想了解南京和北京的市民对最低生活保障的满意程度是否相同。他们从南京抽出600居民，北京抽取600居民，每个居民对满意程度(非常满意、满意、不满意、非常不满意)任选一种，且只能选一种。将统计结果键入Excel工作表中，如图6</p>

<p><img src="https://s2.ax1x.com/2019/11/04/KxekWQ.jpg" alt="KxekWQ.jpg" /></p>

<p>所示。 Image:图6 抽查统计结果.jpg</p>

<p>下面是利用Excel解决此问题的步骤。</p>

<p>(1)零假设H0：南京和北京居民对最低生活保障满意程度的比例相同。</p>

<p>(2)确定自由度为(4-1)×(2-1)=3，选择显著水平α=0.05。</p>

<p>(3)求解卡方检验的l临界值，在Excel单元格中键入“=CHIINV(0.05，3)”，按回车键得临界值为7.81。</p>

<p>(4)计算北京和南京不同满意程度的期望值，在单元格B11和C11中分别键入“=$B$7<em>D3/$D$7”和“=$C$7</em>D3/$D$7”，选中B11：C11，按住C11右下角填充控制点，填充至C14。</p>

<p>(5)计算卡方统计量，在单元格B19中键入“=(B3-B11)^2/B11”，其余单元格依次类推，结果如图7所示。</p>

<p><img src="https://s2.ax1x.com/2019/11/04/KxeeLq.jpg" alt="KxeeLq.jpg" /></p>

<script type="math/tex; mode=display">X^2=\sum\frac{(f_0-f_e)^2}{f_e}=14.3875</script>

<p>(6)比较统计量和临界值，统计量1.3875小于临界值7.81，故接受零假设。</p>

<h2 id="参考文献">参考文献</h2>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>1. 1.0 1.1 张文彤,邝春伟编著.第16章 无序分类变量的统计推断——卡方检验 SPSS统计分析基础教程 第2版.高等教育出版社,2011.11.
2.刘铁民主编.第十章 安全生产统计分析 安全生产管理知识 2006版.中国大百科全书出版社,2006年05月第1版.
3.卡方检验的应用条件[J].中国医药科学,2013,(第2期).
4.孙志刚,杨聪.第八章 假设检验 Excel在经济与数理统计中的应用.中国电力出版社,2004年01月第1版.
</code></pre></div></div>

<p>原文：<a href="https://wiki.mbalib.com/wiki/卡方检验" title="卡方检验">卡方检验</a></p>

</div>

<div style="text-align:center">
	<div>
		<b>本文位置：</b><a href="https://zzj666.github.com">zzj666's Little Site</a> » <a href="https://zzj666.github.com/math/chi-square-test.html" title="">卡方检验</a>
	</div>
</div>


<!-- next and previous -->
<div style="margin:10px">
  <span class="next">
		
			<a href="">
				
			</a>
		 
  </span>
  
  <div style="float:right">
  <span class="prev" >
		
			<a href="">
				
			</a>
		
  </span>
  </div>
  
</div>

<hr>

</div>

        </div>
        <!-- Blog Sidebar Widgets Column -->
        <div class="col-md-4">
          <!-- Side Widget Well -->
          <div class="well">
            <h4>
              资源
            </h4>
			      <div class="row">
                        <div class="col-lg-12">
              <ul class="list-unstyled">
			  	<li>
                <a href="/pub/app/webui-aria2/docs/index.html" target="_blank" rel="nofollow">
                  Webui-Aria2
                </a>
				</li>
				<li>
                <a href="https://www.matheditor.cn/" target="_blank" rel="nofollow">
                  LaTeX公式编辑器1
                </a>
				</li>
				<li>
                <a href="http://www.math.org.cn/tex/index.html" target="_blank" rel="nofollow">
                  LaTeX公式编辑器2
                </a>
				</li>
                <li>
                <a href="/pub/books/math/math/tj_math.html" target="_blank" rel="nofollow">
                  数学基础知识
                </a>
				</li>
				<li>
                <a href="/pub/books/math/fortran/Index.htm" target="_blank" rel="nofollow">
                  Fortran77和90/95编程入门
                </a><br /><i><font size="2">（中国科技大学天文与应用物理系，丁泽军编）</font></i>
				</li>
                <li>
                <a href="/pub/books/gits/git-guide/index.html" target="_blank" rel="nofollow">
                  git - 简易指南
                </a>
				</li>
				<a href="/pub/books/gits/simplegit/index.htm" target="_blank" rel="nofollow">
                  深入浅出Git教程
                </a>（转载）
				</li>
			  </ul>
          </div>
 
            </div>
          </div>

          <!-- Side Widget Well -->
          <div class="well-ad">
            <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<!-- BlogRightB -->
<ins class="adsbygoogle"
	 style="display:inline-block;width:336px;height:280px"
	 data-ad-client="ca-pub-3557776493079475"
	 data-ad-slot="4042604803"></ins>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script> 
          </div>

		      <!-- Blog Recent Well -->
          <div class="well">
            <h4>
              最新文章
            </h4>
            <div class="row">
                                  
              <div class="col-lg-12">
                <ul class="list-unstyled">
                     
                </ul>
              </div> 
            </div>
          </div>
        </div>
      </div>
      <!-- /.row -->

      <!-- Footer -->
      <footer>
        <div class="row">
          <div class="col-lg-12">
            <div style="text-align:center;margin-top:15px;">
	<a href="https://math2all.github.io">zzj666</a> 小站，由 Jekyll 生成。
	<br />本作品采用<a rel="license" href="http://creativecommons.org/licenses/by/4.0/">知识共享署名 4.0 国际许可协议</a>进行许可。
	<br />除非单独声明。
</div>
 
          </div>
          <!-- /.col-lg-12 -->
        </div>
        <!-- /.row -->
      </footer>
    </div>
    <!-- /.container 
    <script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
 -->
  </body>

</html>
